<!doctype html>
<html>
<head>
<meta http-equiv="X-UA-Compatible" content="IE=edge" />
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
<meta name="author" content="山下陽介 (Yousuke Yamashita)  国立環境研究所 (National Institute for Environmental Studies, NIES)" />
<link rel="icon" type="image/vnd.microsoft.icon" href="/matplotlib/favicon.ico" />
<link rel="apple-touch-icon" type="image/png" href="/matplotlib/apple-touch-icon-180x180.png" />
<link rel="icon" type="image/png" href="/matplotlib/icon-192x192.png" />
<!-- Mobile Internet Explorer allows us to activate ClearType technology for smoothing fonts for easy reading -->
<meta http-equiv="cleartype" content="on" />
<!-- Specify whether or not telephone numbers in the HTML content should appear as hypertext links -->
<meta name="format-detection" content="telephone=no" />
<!-- Changes the logical window size used when displaying a page mobile browsers -->
<meta name = "viewport" content = "width = device-width, initial-scale=1, user-scalable=yes" />

<meta name="robots" content="all" />
<meta name="http-equiv" content="X-Robots-Tag : all" />
<meta name="googlebot" content="all" />
<meta name="description" content="" />
<meta name="keywords" content="" />
<link href="design.css" rel="stylesheet" type="text/css" />
<title>気象データ解析のためのmatplotlibの使い⽅</title>
</head>

<body link="#0000FF" vlink="#0000FF">

<div id="nesting">
<a href="/">ホーム</a> &gt; <a href="index.html">matplotlibの使い⽅</a> &gt; python
</div>
<article>
<center><h1 id="top">PythonのTIPS</h1></center>
<br />
<!-- 目次 -->
<h2 id="contents">目次</h2>
<div class="contents">
  <!-- 時刻形式 -->
  <ul class="list1"><li><a href="#time">時刻形式</a>
    <ul class="list2">
      <li><a href="#time_1">時刻形式データの作成</a></li>
      <li><a href="#time_2">時刻形式データから年、月、日などを取り出</a></li>
      <li><a href="#time_3">時刻形式データから書式指定して取り出す</a></li>
      <li><a href="#time_4">時刻形式データの演算</a></li>
      <li><a href="#time_5">1ヶ月後、1年後を計算する</a></li>
      <li><a href="#time_6">月末の日を計算する</a></li>
     </ul>
  </li></ul>
  <!-- ディレクトリ -->
  <ul class="list1"><li><a href="#dir">ディレクトリ</a>
    <ul class="list2">
      <li><a href="#dir_1">ディレクトリのパスを結合する</a></li>
      <li><a href="#dir_2">ディレクトリの一覧を取得する</a></li>
     </ul>
  </li></ul>
  <!-- 環境変数 -->
  <ul class="list1"><li><a href="#env">環境変数</a>
    <ul class="list2">
      <li><a href="#env_1">環境変数を取得する</a></li>
     </ul>
  </li></ul>
  <!-- 文字列 -->
  <ul class="list1"><li><a href="#char">文字列</a>
    <ul class="list2">
      <li><a href="#char_1">大文字と小文字の変換</a></li>
      <li><a href="#char_2">文字列から改行記号を取り除く</a></li>
      <li><a href="#char_3">文字列からboolへの変換</a></li>
     </ul>
  </li></ul>
</div>

<!-- ここから本文 -->
<!-- 時刻形式 -->
<h3><div class="headline1" id="time">時刻形式</div></h3>
<h4><div class="headline2" id="time_1">時刻形式データの作成</div></h4>
<div class="text1">
datetimeで扱うことのできる時刻形式データを作成する
<ul class="list1">
<li>datetime.dateを使う（日付のみを扱う場合）
<pre>
from datetime import date
time = date(年, 月, 日)
</pre>
年、月、日は整数で与える
</li><br />
<li>datetime.datetimeを使う（日付と時刻を扱う場合）
<pre>
from datetime import datetime
time = datetime(年, 月, 日, 時, 分, 秒)
</pre>
年、月、日、時、分、秒は整数で与える
</li><br />
<li>現在時刻を与える場合（ローカルタイム）
<pre>
from datetime import datetime
time = datetime.now()
</pre>
システム時刻をローカルタイムで取得
</li><br />
<li>現在時刻を与える場合（UTC）
<pre>
from datetime import datetime
time = datetime.utcnow() 
</pre>
システム時刻をUTCで取得
</li><br />
<li>pandas.to_datetimeを使う（文字列から日付と時刻に変換）
<pre>
import pandas as pd
time = pd.to_datetime("年-月-日 時:分:秒") # ISO形式の場合
</pre>
例えば、"2021-09-04 12:00:00"のような形式<br /><br />
次のように数字の羅列でもよい
<pre>
time = pd.to_datetime("年月日時分秒")
</pre>
例えば、"20210904120000"のような形式
</li>
</ul>
</div>
<br />
<br />

<h4><div class="headline2" id="time_2">時刻形式データから年、月、日などを取り出す</div></h4>
<div class="text1">
時刻形式データ.取り出したい要素
<ul class="list1">
<li>datetime.dateの場合
<pre>
from datetime import date
time = date(2021, 9, 4)
print(time.year)
print(time.moth)
print(time.day)
</pre>
time.yearで2021、time.monthで9、time.dayで4が整数値で返される<br />
時、分、秒を表示しようとするとエラーになる</li><br />
<li>datetime.datetimeの場合
<pre>
from datetime import datetime
time = datetime(2021, 9, 4, 12, 30, 0)
print(time.year)
print(time.moth)
print(time.day)
print(time.hour)
print(time.minute)
print(time.second)
</pre>
time.yearで2021、time.monthで9、time.dayで4、time.hourで12、time.minuteで30、time.secondで0が整数値で返される<br />
pandas.to_datetimeの場合も挙動は同じ</li><br />
</ul>
</div>
<br />
<br />

<h4><div class="headline2" id="time_3">時刻形式データから書式指定して取り出す</div></h4>
<div class="text1">
datetime.strftimeを使う
<ul class="list1">
<li>年/月/日
<pre>
from datetime import datetime
time = datetime(2021, 9, 4, 12, 30, 0)
print(time.strftime("%Y/%m/%d"))
</pre>
"2021/09/04"の文字列が表示される<br />
時刻表記の書式については<a href="forms.html#time">時刻表記に用いられる書式指定子一覧</a>参照</li><br />
<li>年/月/日 時:分:秒
<pre>
from datetime import datetime
time = datetime(2021, 9, 4, 12, 30, 0)
print(time.strftime("%Y/%m/%d %H:%M:%S"))
</pre>
"2021/09/04 12:30:00" の文字列が表示される</li><br />
<li>ISOフォーマット
<pre>
from datetime import datetime
time = datetime(2021, 9, 4, 12, 30, 0)
print(time.isoformat())
</pre>
"2021-09-04T12:30:00" の文字列が表示される</li><br />
</ul>
</div>
<br />
<br />

<h4><div class="headline2" id="time_4">時刻形式データの演算</div></h4>
<div class="text1">
datetime.timedeltaを使うことで時刻形式データの演算を行うことができる
<ul class="list1">
<li>datetime.datetimeで作成したものを利用
<pre>
from datetime import datetime, timedelta
time = datetime(2021, 9, 4, 12, 0, 0)
time_new = time + timedelta(hours=12)
</pre>
9/4 12時から12時間後の9/5 0時になる
</li><br />
<li>日単位での演算も可能
<pre>
from datetime import datetime, timedelta
time = datetime(2021, 9, 4, 12, 0, 0)
time_new = time + timedelta(days=2)
</pre>
9/4 12時から2日後の9/6 12時になる
</li><br />
<li>減算することもできる
<pre>
from datetime import datetime, timedelta
time = datetime(2021, 9, 4, 12, 0, 0)
time_new = time - timedelta(days=2)
</pre>
9/4 12時から2日前の9/2 12時になる
</li><br />
<li>pandas.to_datetimeで作成したものを利用
<pre>
import pandas as pd
from datetime import timedelta
time = pd.to_datetime("20210904120000")
time_new = time + timedelta(hours=12)
</pre>
datetimeで作成した場合と同様に演算可能
</li>
</ul>
</div>
<br />
<br />

<h4><div class="headline2" id="time_5">1ヶ月後、1年後を計算する</div></h4>
<div class="text1">
datetime.timedeltaでは、1ヶ月後、1年後などを指定するとエラーになる<br />
dateutil.relativedeltaを使うと加算・減算が可能
<ul class="list1">
<li>1ヶ月後の計算
<pre>
from datetime import datetime
from dateutil.relativedelta import relativedelta
time = datetime(2021, 9, 4, 12, 0, 0)
time_new = time + relativedelta(months=1)
</pre>
9/4 12時から1ヶ月後の10/4 12時になる
</li><br />
<li>1年後の計算
<pre>
from datetime import datetime
from dateutil.relativedelta import relativedelta
time = datetime(2021, 9, 4, 12, 0, 0)
time_new = time + relativedelta(years=2)
</pre>
2021/9/4 12時から1年後の2022/9/4 12時になる
</li><br />
<li>閏年をまたいだ場合
<pre>
from datetime import datetime
from dateutil.relativedelta import relativedelta
time = datetime(2021, 9, 4, 12, 0, 0)
time_new = time + relativedelta(years=4)
</pre>
閏年をまたいでも、4年後の同じ日の2025/9/4 12時になる
</li>
</ul>
</div>
<br />
<br />

<h4><div class="headline2" id="time_6">月末の日を計算する</div></h4>
<div class="text1">
dateutil.relativedeltaの１ヶ月後の計算を応用して月末の日を計算する
<pre>
from datetime import datetime
from dateutil.relativedelta import relativedelta
time = datetime(2021, 8, 1, 0, 0, 0)
time_new = time + relativedelta(months=1) - relativedelta(days=1)
</pre>
</div>
<br />
<br />


<!-- ディレクトリ -->
<h3><div class="headline1" id="dir">ディレクトリ</div></h3>
<h4><div class="headline2" id="dir_1">ディレクトリのパスを結合する</div></h4>
<div class="text1">
os.path.joinを使う
<pre>
import os
dir1 = "dir_name1"
dir2 = "dir_name2"
dir_path = os.path.join(dir1, dir2)
</pre>
dir_pathには、dir_name1/dir_name2が入る<br />
UNIX環境では/、Windows環境では¥が設定されるので、OSに依存しないコードが書ける
</div>
<br />
<br />

<h4><div class="headline2" id="dir_2">ディレクトリの一覧を取得する</div></h4>
<div class="text1">
os.listdirを使う
<pre>
import os
input_dir = "ディレクトリのパス"
files = os.listdir(input_dir)
for f in files:
&nbsp; &nbsp; print(os.path.join(input_dir, f))
</pre>
ファイル一覧をリストとして取得し、パスを表示
</div>
<br />
<br />


<!-- 環境変数 -->
<h3><div class="headline1" id="env">環境変数</div></h3>
<h4><div class="headline2" id="env_1">環境変数を取得する</div></h4>
<div class="text1">
os.environ.getを使う
<pre>
import os
cur = os.environ.get('PWD')
</pre>
カレントディレクトリを取得する
</div>
<br />
<br />


<!-- 文字列 -->
<h3><div class="headline1" id="char">文字列</div></h3>
<h4><div class="headline2" id="char_1">大文字と小文字の変換</div></h4>
<div class="text1">
文字列のメソッドを利用する
<ul class="list1">
<li>全て小文字にする
<pre>"ABc".lower()</pre>
出力：abc</li><br />
<li>全て大文字にする
<pre>"aBc".upper()</pre>
出力：ABC</li><br />
<li>大文字と小文字を逆にする
<pre>"aBc".swapcase()</pre>
出力：AbC</li><br />
<li>先頭のみ大文字にする
<pre>"aBc".capitalize()</pre>
出力：Abc</li><br />
<li>単語の先頭を大文字にする
<pre>"the abc".title()</pre>
出力：The Abc</li><br />
</ul>
</div>
<br />
<br />

<h4><div class="headline2" id="char_2">文字列から改行記号を取り除く</div></h4>
<div class="text1">
文字列のメソッドを利用する
<ul class="list1">
<li>改行コード（LF）を取り除く
<pre>"文字列".replace('\n', '')</pre>
</li>
<li>タブを取り除く場合
<pre>"文字列".replace('\t', '')</pre>
</li>
<li>機種依存なく改行コードを取り除く
<pre>"".join("文字列".splitlines())</pre>
splitlinesでLFもCRLFも分割し、joinで結合する
</li><br />
<li>改行コードをLFに置き換える
<pre>"¥n".join("文字列".splitlines())</pre>
</li>
</ul>
</div>
<br />
<br />

<h4><div class="headline2" id="char_3">文字列からboolへの変換</div></h4>
<div class="text1">
文字列が"true"、"t"、"yes"、"1"のいずれかの場合にTrueとする。大文字・小文字は区別しない。
<pre>
b = "文字列".lower() in ["true", "t", "yes", "1"]
</pre>
bにはTrueかFalseが入っている
</div>
<br />
<br />


<br />
<br />
<br />
<br />

<small><a href="#top">[top]</a></small> <br />
<hr width="105%" />
</article>
</body>
<footer>
<p>最終更新日：2022/03/08</p>
<p>Copyright (C) 2021, Yousuke Yamashita</p>
</footer>
</html>
